const tape = require('tape-async')
const fetch = require('node-fetch')

const url1 = 'http://127.0.0.1:3005'
const url2 = 'http://127.0.0.1:3006'

const getJSON = x => fetch(x).then(r => r.json())

tape('two addons serve the same manifest', async t => {
	t.deepEqual(
		await getJSON(url1+'/manifest.json'),
		await getJSON(url2+'/manifest.json'),
		'manifest is the same'
	)
})

tape('two addons serve the same metas', async t => {
	t.deepEqual(
		(await getJSON(url1+'/catalog/movie/top.json')).metas,
		(await getJSON(url2+'/catalog/movie/top.json')).metas,
		'manifest is the same'
	)
})
